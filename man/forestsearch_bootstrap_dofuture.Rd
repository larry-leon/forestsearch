% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/bootstrap_dofuture_main.r
\name{forestsearch_bootstrap_dofuture}
\alias{forestsearch_bootstrap_dofuture}
\title{ForestSearch Bootstrap with doFuture Parallelization}
\usage{
forestsearch_bootstrap_dofuture(
  fs.est,
  nb_boots,
  details = FALSE,
  show_three = FALSE,
  parallel_args = list()
)
}
\arguments{
\item{fs.est}{List. ForestSearch results object from \code{\link{forestsearch}}.
Must contain \code{df.est} (data frame) and \code{args_call_all} (list of arguments).}

\item{nb_boots}{Integer. Number of bootstrap samples (recommend 500-1000).}

\item{details}{Logical. If \code{TRUE}, prints detailed progress information.
Default: \code{FALSE}.}

\item{show_three}{Logical. If \code{TRUE}, shows verbose output for first 3
bootstrap iterations for debugging. Default: \code{FALSE}.}

\item{parallel_args}{List. Parallelization configuration with elements:
\itemize{
\item \code{plan}: Character. One of "multisession", "multicore", "callr",
or "sequential"
\item \code{workers}: Integer. Number of parallel workers
\item \code{show_message}: Logical. Show parallel setup messages
}
If empty list, inherits settings from original forestsearch call.}

\item{create_summary}{Logical. If \code{TRUE}, generates enhanced summary
output with formatted tables and diagnostics. Default: \code{TRUE}.}

\item{create_plots}{Logical. If \code{TRUE}, generates diagnostic plots
of bootstrap distributions. Requires \code{ggplot2}. Default: \code{FALSE}.}
}
\value{
List with the following components:
\describe{
\item{results}{Data.table with bias-corrected estimates for each bootstrap iteration}
\item{SG_CIs}{List of confidence intervals for H and Hc (raw and bias-corrected)}
\item{FSsg_tab}{Formatted table of subgroup estimates}
\item{Ystar_mat}{Matrix (nb_boots x n) of bootstrap sample indicators}
\item{H_estimates}{Detailed estimates for subgroup H}
\item{Hc_estimates}{Detailed estimates for subgroup Hc}
\item{summary}{(If create_summary=TRUE) Enhanced summary with tables and diagnostics}
}
}
\description{
Orchestrates bootstrap analysis for ForestSearch using doFuture parallelization.
Implements bias correction methods to adjust for optimism in subgroup selection.
}
\section{Bias Correction Methods}{

Two bias correction approaches are implemented:
\enumerate{
\item \strong{Method 1 (Simple Optimism)}:
\deqn{H_{adj1} = H_{obs} - (H^*_{*} - H^*_{obs})}
where \eqn{H^*_{*}} is the new subgroup HR on bootstrap data and
\eqn{H^*_{obs}} is the new subgroup HR on original data.

\item \strong{Method 2 (Double Bootstrap)}:
\deqn{H_{adj2} = 2 \times H_{obs} - (H_{*} + H^*_{*} - H^*_{obs})}
where \eqn{H_{*}} is the original subgroup HR on bootstrap data.
}
}

\section{Variable Naming Convention}{

\itemize{
\item \code{H}: Original subgroup (harm/questionable, treat.recommend == 0)
\item \code{Hc}: Complement subgroup (recommend, treat.recommend == 1)
\item \code{_obs}: Estimate from original data
\item \code{_star}: Estimate from bootstrap data
\item \code{_biasadj_1}: Bias correction method 1
\item \code{_biasadj_2}: Bias correction method 2
}
}

\section{Performance}{

Typical runtime: 1-5 seconds per bootstrap iteration. For 1000 bootstraps with
6 workers, expect 3-10 minutes total. Memory usage scales with dataset size
and number of workers.
}

\section{Requirements}{

\itemize{
\item Original \code{fs.est} must have identified a valid subgroup
\item Requires packages: \code{data.table}, \code{foreach}, \code{doFuture},
\code{survival}
\item For plots: requires \code{ggplot2}
}
}

\examples{
\dontrun{
# Run ForestSearch
fs_result <- forestsearch(
  df.analysis = mydata,
  outcome.name = "time",
  event.name = "status",
  treat.name = "treatment",
  confounders.name = c("age", "sex", "stage")
)

# Run bootstrap with bias correction
boot_results <- forestsearch_bootstrap_dofuture(
  fs.est = fs_result,
  nb_boots = 1000,
  parallel_args = list(
    plan = "multisession",
    workers = 6,
    show_message = TRUE
  ),
  create_summary = TRUE,
  create_plots = TRUE
)

# View results
print(boot_results$FSsg_tab)
print(boot_results$summary$table)

# Check success rate
mean(!is.na(boot_results$results$H_biasadj_2))
}

}
\seealso{
\code{\link{forestsearch}} for initial subgroup identification
\code{\link{bootstrap_results}} for the core bootstrap worker function
\code{\link{build_cox_formula}} for Cox formula construction
\code{\link{fit_cox_models}} for Cox model fitting
}
