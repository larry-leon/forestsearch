% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/grf_functions_fixed.r,
%   R/improved_grf_functions.r
\name{grf.subg.harm.survival}
\alias{grf.subg.harm.survival}
\title{GRF Subgroup Identification for Survival Data}
\usage{
grf.subg.harm.survival(
  data,
  confounders.name,
  outcome.name,
  event.name,
  id.name,
  treat.name,
  frac.tau = 1,
  n.min = 60,
  dmin.grf = 0,
  RCT = TRUE,
  details = FALSE,
  sg.criterion = "mDiff",
  maxdepth = 2,
  seedit = 8316951
)

grf.subg.harm.survival(
  data,
  confounders.name,
  outcome.name,
  event.name,
  id.name,
  treat.name,
  frac.tau = 1,
  n.min = 60,
  dmin.grf = 0,
  RCT = TRUE,
  details = FALSE,
  sg.criterion = "mDiff",
  maxdepth = 2,
  seedit = 8316951
)
}
\arguments{
\item{data}{Data frame containing the analysis data.}

\item{confounders.name}{Character vector of confounder variable names.}

\item{outcome.name}{Character. Name of outcome variable (e.g., time-to-event).}

\item{event.name}{Character. Name of event indicator variable (0/1).}

\item{id.name}{Character. Name of ID variable.}

\item{treat.name}{Character. Name of treatment group variable (0/1).}

\item{frac.tau}{Numeric. Fraction of maximum follow-up time to use as horizon (0-1). Default: 1.0.}

\item{n.min}{Integer. Minimum subgroup size required. Default: 60.}

\item{dmin.grf}{Numeric. Minimum treatment effect difference (on RMST scale) required. Default: 0.0.}

\item{RCT}{Logical. Is the data from a randomized controlled trial? If TRUE, uses W.hat=0.5. Default: TRUE.}

\item{details}{Logical. Print diagnostic information during execution? Default: FALSE.}

\item{sg.criterion}{Character. Subgroup selection criterion:
\itemize{
\item "mDiff": Select subgroup with maximum treatment effect difference (default)
\item "Nsg": Select largest subgroup meeting dmin.grf threshold
}}

\item{maxdepth}{Integer. Maximum tree depth to evaluate (1, 2, or 3). Default: 2.}

\item{seedit}{Integer. Random seed for reproducibility. Default: 8316951.}
}
\value{
A list containing:
\describe{
\item{data}{Original data with added treatment recommendation and node assignments}
\item{grf.gsub}{Optimal subgroup information (effect difference, size, etc.)}
\item{sg.harm.id}{Subgroup definition as a string (e.g., "age <= 65")}
\item{tree.cuts}{All cut points from the selected tree}
\item{tree.names}{Variable names used in the selected tree}
\item{tree1.cuts, tree2.cuts, tree3.cuts}{Cut points from each depth}
\item{tree1.names, tree2.names, tree3.names}{Variable names from each depth}
\item{harm.any}{All candidate subgroups with positive treatment effects}
\item{tree}{Selected policy tree object}
\item{tau.rmst}{Restricted mean survival time horizon used}
\item{tree1, tree2, tree3}{Policy tree objects for each depth}
}

A list containing:
\describe{
\item{data}{Original data with added treatment recommendation and node assignments}
\item{grf.gsub}{Optimal subgroup information (effect difference, size, etc.)}
\item{sg.harm.id}{Subgroup definition as a string (e.g., "age <= 65")}
\item{tree.cuts}{All cut points from the selected tree}
\item{tree.names}{Variable names used in the selected tree}
\item{tree1.cuts, tree2.cuts, tree3.cuts}{Cut points from each depth}
\item{tree1.names, tree2.names, tree3.names}{Variable names from each depth}
\item{harm.any}{All candidate subgroups with positive treatment effects}
\item{tree}{Selected policy tree object}
\item{tau.rmst}{Restricted mean survival time horizon used}
\item{tree1, tree2, tree3}{Policy tree objects for each depth}
}
}
\description{
Identifies subgroups with differential treatment effect using generalized random forests (GRF)
and policy trees. The function fits causal survival forests at multiple tree depths and selects
the optimal subgroup based on either maximum difference in treatment effect or largest subgroup size.

Identifies subgroups with differential treatment effect using generalized random forests (GRF)
and policy trees. The function fits causal survival forests at multiple tree depths and selects
the optimal subgroup based on either maximum difference in treatment effect or largest subgroup size.
}
\details{
The function works in three main steps:
\enumerate{
\item Fits a causal survival forest to estimate treatment effects
\item Fits policy trees at depths 1-3 to identify subgroups
\item Evaluates subgroups based on effect size and sample size criteria
}

A subgroup is only returned if:
\itemize{
\item Treatment effect difference >= dmin.grf
\item Subgroup size >= n.min
\item Subgroup size < total sample size (not the entire population)
}

The function works in three main steps:
\enumerate{
\item Fits a causal survival forest to estimate treatment effects
\item Fits policy trees at depths 1-3 to identify subgroups
\item Evaluates subgroups based on effect size and sample size criteria
}

A subgroup is only returned if:
\itemize{
\item Treatment effect difference >= dmin.grf
\item Subgroup size >= n.min
\item Subgroup size < total sample size (not the entire population)
}
}
\examples{
\dontrun{
# Identify subgroups in RCT data
result <- grf.subg.harm.survival(
  data = trial_data,
  confounders.name = c("age", "sex", "baseline_score"),
  outcome.name = "time",
  event.name = "event",
  id.name = "patient_id",
  treat.name = "treatment",
  n.min = 50,
  dmin.grf = 0.1
)
}
\dontrun{
# Identify subgroups in RCT data
result <- grf.subg.harm.survival(
  data = trial_data,
  confounders.name = c("age", "sex", "baseline_score"),
  outcome.name = "time",
  event.name = "event",
  id.name = "patient_id",
  treat.name = "treatment",
  n.min = 50,
  dmin.grf = 0.1
)
}
}
