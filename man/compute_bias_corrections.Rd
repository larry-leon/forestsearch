% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/bootstrap_dofuture.R
\name{compute_bias_corrections}
\alias{compute_bias_corrections}
\title{Compute Bias Corrections for Bootstrap Subgroup Estimates}
\usage{
compute_bias_corrections(
  run_bootstrap,
  H_obs,
  Hc_obs,
  h_star,
  hc_star,
  cox.formula.boot
)
}
\arguments{
\item{run_bootstrap}{List. Output from \code{\link{forestsearch}} run on
bootstrap sample, or a \code{try-error} object if the run failed.}

\item{H_obs}{Numeric. Observed log hazard ratio for subgroup H from original
sample. Used as the reference point for bias correction.}

\item{Hc_obs}{Numeric. Observed log hazard ratio for subgroup H^c from
original sample.}

\item{h_star}{Numeric. Log hazard ratio for H estimated on bootstrap sample
using original subgroup definition.}

\item{hc_star}{Numeric. Log hazard ratio for H^c estimated on bootstrap sample
using original subgroup definition.}

\item{cox.formula.boot}{Formula. Cox model formula for estimation.}
}
\value{
Named list with components:
\describe{
\item{H_biasadj_1}{Numeric or NA. Bias correction method 1 for H}
\item{H_biasadj_2}{Numeric or NA. Bias correction method 2 for H}
\item{Hc_biasadj_1}{Numeric or NA. Bias correction method 1 for H^c}
\item{Hc_biasadj_2}{Numeric or NA. Bias correction method 2 for H^c}
\item{tmins_search}{Numeric or NA. Search time in minutes}
\item{max_sg_est}{Numeric or NA. Maximum subgroup HR estimate}
\item{prop_maxk}{Numeric or NA. Proportion using max K factors}
\item{L}{Integer or NA. Number of factors evaluated}
\item{max_count}{Integer or NA. Total factor combinations}
}
All values are \code{NA} if \code{run_bootstrap} is an error or found no
valid subgroup.
}
\description{
Helper function that computes bias-corrected estimates for both subgroups
(H and H^c) using two correction methods. Handles cases where ForestSearch
fails to identify a subgroup.
}
\note{
This is an internal helper function not meant for direct user calls.
It's extracted from \code{\link{bootstrap_results}} to improve readability
and testability.
}
\section{Bias Correction Formulas}{

When a valid subgroup is found on the bootstrap sample:
\itemize{
\item \code{H_biasadj_1 = H_obs - (Hstar_star - Hstar_obs)}
where \code{Hstar_star} is the HR for the \emph{new} subgroup evaluated
on the bootstrap sample, and \code{Hstar_obs} is the HR for the new
subgroup evaluated on the original sample (optimism estimate).
\item \code{H_biasadj_2 = 2*H_obs - (H_star + Hstar_star - Hstar_obs)}
incorporates both the bootstrap estimate (\code{H_star}) and the
optimism correction.
}
}

\section{Error Handling}{

The function gracefully handles three failure modes:
\enumerate{
\item \code{run_bootstrap} is a \code{try-error}: Returns all \code{NA}
\item \code{run_bootstrap$sg.harm} is \code{NULL}: No subgroup found, returns \code{NA}
\item Cox model fitting fails: Wrapped in \code{try()} to prevent crashes
}
}

\seealso{
\code{\link{bootstrap_results}} for the main bootstrap loop
}
